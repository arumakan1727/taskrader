<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8">
  <meta content="width=device-width,initial-scale=1,minimal-ui" name="viewport">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700,400italic|Material+Icons">
  <link rel="stylesheet" href="https://unpkg.com/vue-material/dist/vue-material.min.css">
  <link rel="stylesheet" href="https://unpkg.com/vue-material/dist/theme/default.css">
  <title>TaskRader</title>
  <style>
    :root {
      --md-theme-default-primary: #008fce;
    }

    .md-empty-state {
      max-width: 470px;
    }

    .min-95vh {
      min-height: 95vh;
    }

    .overlay-dark {
      position: absolute;
      top: 0;
      left: 0;
      z-index: 9999;
      width: 100%;
      height: 100%;
      background: rgba(240, 240, 240, .6);
    }

    .mb-3 {
      margin-bottom: 12px;
    }

    .ml-1 {
      margin-left: 4px;
    }

    .ml-4 {
      margin-left: 16px;
    }

    .mr-4 {
      margin-right: 16px;
    }

    .mx-4 {
      margin-left: 16px;
      margin-right: 16px;
    }

    .d-flex {
      display: flex;
    }

    .text-black {
      color: #000;
    }

    .text-red {
      color: #ff2424;
    }

    .text-orange {
      color: #d76300;
    }

    .text-white {
      color: #fff;
    }

    .bg-black {
      background: #000;
    }

    .bg-red {
      background: #ff2424;
    }

    .bg-orange {
      background: darkorange;
    }


    .centering-flex-container {
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .w-100 {
      width: 100%;
    }

    .h-100 {
      height: 100%;
    }

    .pill {
      padding: .25rem .5rem;
      border-radius: 999px;
      font-weight: bold;
    }
  </style>
</head>

<body>
  <div id="app">
    <div class="page-container">
      <md-app>
        <md-app-toolbar class="md-primary">
          <md-button class="md-icon-button" @click="toggleMenu" v-if="!state.menuVisible">
            <md-icon>menu</md-icon>
          </md-button>
          <span class="md-title">TaskRader</span>
        </md-app-toolbar>

        <md-app-drawer :md-active.sync="state.menuVisible" md-persistent="mini" style="width:200px;">
          <md-toolbar class="md-transparent" md-elevation="0">
            <span>ãƒ¡ãƒ‹ãƒ¥ãƒ¼</span>
            <div class="md-toolbar-section-end">
              <md-button class="md-icon-button md-dense" @click="toggleMenu">
                <md-icon>keyboard_arrow_left</md-icon>
              </md-button>
            </div>
          </md-toolbar>

          <md-list>
            <md-list-item @click="switchTo('HOME')">
              <md-icon>home</md-icon>
              <span class="md-list-item-text">ãƒ›ãƒ¼ãƒ </span>
            </md-list-item>
            <md-list-item @click="switchTo('SETTING')">
              <md-icon>settings</md-icon>
              <span class="md-list-item-text">è¨­å®š</span>
            </md-list-item>
            <md-list-item>
              <md-icon>help</md-icon>
              <span class="md-list-item-text">ãƒ˜ãƒ«ãƒ—</span>
            </md-list-item>
          </md-list>
        </md-app-drawer>

        <md-app-content class="min-95vh">
          <template v-if="state.tab === 'HOME'">
            <h1 class="md-display-1">ãƒ›ãƒ¼ãƒ </h1>

            <div v-if="!state.initialized" class="centering-flex-container w-100" style="margin-top: 120px">
              <md-progress-spinner :md-diameter="160" :md-stroke="12" md-mode="indeterminate">
              </md-progress-spinner>
            </div>

            <md-empty-state v-else-if="nothingLogined" md-rounded :md-size="470" md-icon="devices_other"
              md-label="èªè¨¼æƒ…å ±ãŒç™»éŒ²ã•ã‚Œã¦ã„ã¾ã›ã‚“" md-description="ã¾ãšã¯å­¦æƒ…ã‚„ EdStem, Teams ã«ãƒ­ã‚°ã‚¤ãƒ³ã™ã‚‹ãŸã‚ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ç­‰ã‚’ç™»éŒ²ã—ã¦ãã ã•ã„ã€‚">
              <md-button class="md-primary md-raised" @click="switchTo('SETTING')">èªè¨¼æƒ…å ±ã®ç™»éŒ²ç”»é¢ã¸</md-button>
            </md-empty-state>

            <div v-else>
              <div class="mx-4" style="display:flex; justify-content:space-between; align-items:center;">
                <h2 class="md-headline mb-3">{{ assignments.length }}ä»¶ã®æœªæå‡ºèª²é¡Œ</h2>
                <md-button @click="fetchAss()" :disabled="state.fetchingAss" class="md-raised md-primary">
                  <md-icon>refresh</md-icon> èª²é¡Œä¸€è¦§ã‚’å†å–å¾—ã™ã‚‹
                </md-button>
              </div>

              <div class="" style="position:relative;">
                <div v-if="state.fetchingAss" class="overlay-dark mx-4" style="width:calc(100% - 32px);">
                  <div class="centering-flex-container w-100 h-100">
                    <md-progress-spinner :md-diameter="120" :md-stroke="12" md-mode="indeterminate">
                    </md-progress-spinner>
                  </div>
                </div>

                <md-table v-model="assignments" :md-sort.sync="sorting.key" :md-sort-order.sync="sorting.ord" md-card
                  :md-sort-fn="sortAssignments" md-fixed-header :md-height="600">

                  <md-table-empty-state md-label="æœªæå‡ºã®èª²é¡Œã¯ã‚ã‚Šã¾ã›ã‚“ğŸ‰" md-description="æœªæå‡ºèª²é¡Œã¯0ä»¶ã§ã™ã€‚ãŠç–²ã‚Œæ§˜ã§ã—ãŸï¼">
                  </md-table-empty-state>

                  <md-table-row slot="md-table-row" slot-scope="{ item }">
                    <md-table-cell md-label="èª²é¡Œå" md-sort-by="title">{{ item.title }}</md-table-cell>
                    <md-table-cell md-label="ç§‘ç›®" md-sort-by="course">{{ item.course }}</md-table-cell>
                    <md-table-cell md-label="ç· ã‚åˆ‡ã‚Š" md-sort-by="due">
                      <template v-if="item.remHours < 0">
                        <span class="text-red">{{ item.fmtDue }}</span>
                        <span class="pill text-red bg-black ml-1">ç· ã‚åˆ‡ã‚Šè¶…é</span>
                      </template>
                      <template v-else-if="item.remHours <= 1">
                        <span class="text-red">{{ item.fmtDue }}</span>
                        <span class="pill text-white bg-red ml-1">æ®‹ã‚Š{{ item.remHours * 60 ^ 0 }}åˆ†</span>
                      </template>
                      <template v-else-if="item.remHours <= 24">
                        <span class="text-red">{{ item.fmtDue }}</span>
                        <span class="pill text-white bg-red ml-1">æ®‹ã‚Š{{ item.remHours ^ 0 }}æ™‚é–“</span>
                      </template>
                      <template v-else-if="item.remHours <= 48">
                        <span class="text-orange">{{ item.fmtDue }}</span>
                        <span class="pill text-white bg-orange ml-1">æ®‹ã‚Š{{ item.remHours ^ 0 }}æ™‚é–“</span>
                      </template>
                      <template v-else>
                        <span>{{ item.fmtDue }}</span>
                      </template>
                    </md-table-cell>
                    <md-table-cell md-label="æå‡ºå…ˆ" md-sort-by="origin">
                      <span class="">{{ item.origin }}</span>
                    </md-table-cell>
                  </md-table-row>
                </md-table>
              </div>

              <div>
                <ul class="text-red">
                  <li v-for="err in assErrors">{{ err.origin }} ã®èª²é¡Œå–å¾—ã§ã‚¨ãƒ©ãƒ¼: <strong>{{ err.message }}</strong></li>
                </ul>
              </div>
            </div>

          </template>

          <template v-else-if="state.tab === 'SETTING'">

          </template>
        </md-app-content>
      </md-app>
    </div>
  </div>

  <script defer src="https://unpkg.com/axios/dist/axios.min.js"></script>
  <script defer src="https://unpkg.com/vue"></script>
  <script defer src="https://unpkg.com/vue-material"></script>
  <script defer src="/file/main.js"></script>
</body>
